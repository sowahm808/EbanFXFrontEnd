import{a as D}from"./chunk-H3UCXOXM.js";import{Aa as M,B as s,D as h,Da as j,E as S,Ea as N,F as _,G as y,H as g,I as x,J as i,Ja as z,K as t,L as f,M as v,N as d,O as p,P as o,R as k,S as C,U as E,ga as w,ha as A,ka as I,na as V,oa as P,ra as T,t as b,v as F,wa as K,x as c,xa as O,y as m,ya as $,za as R}from"./chunk-TNJDMAVS.js";import"./chunk-ULBIGD3G.js";import"./chunk-FEBVYFP7.js";import"./chunk-JM4337FT.js";import"./chunk-BVYU3FJT.js";import"./chunk-JDETYR3C.js";import"./chunk-7SKQ7KRS.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-REYR55MP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import"./chunk-TJJGX4BS.js";var L=(r,u)=>u.id;function B(r,u){r&1&&(i(0,"div",3),o(1,"No pending KYC reviews."),t())}function H(r,u){if(r&1){let e=v();i(0,"ion-item")(1,"ion-label")(2,"h3"),o(3),t(),i(4,"p"),o(5),t(),i(6,"ion-button",4),d("click",function(){let n=c(e).$implicit,l=p();return m(l.approve(n.id))}),o(7,"Approve"),t(),i(8,"ion-button",5),d("click",function(){let n=c(e).$implicit,l=p();return m(l.reject(n.id))}),o(9,"Reject"),t()()()}if(r&2){let e=u.$implicit;s(3),C("",e.fullName," (",e.email,")"),s(2),k("Submitted: ",e.submittedAt,"")}}function Y(r,u){if(r&1){let e=v();i(0,"ion-item")(1,"ion-label")(2,"h3"),o(3),t(),i(4,"ion-button",4),d("click",function(){let n=c(e).$implicit,l=p();return m(l.confirm(n.id))}),o(5,"Confirm funds"),t(),i(6,"ion-button",4),d("click",function(){let n=c(e).$implicit,l=p();return m(l.sent(n.id))}),o(7,"Mark sent"),t(),i(8,"ion-button",4),d("click",function(){let n=c(e).$implicit,l=p();return m(l.complete(n.id))}),o(9,"Mark completed"),t(),i(10,"ion-button",6),d("click",function(){let n=c(e).$implicit,l=p();return m(l.flag(n.id))}),o(11,"Flag suspicious"),t()()()}if(r&2){let e=u.$implicit;s(3),C("",e.id," \u2022 ",e.status,"")}}var Z=(()=>{class r{constructor(){this.api=b(D),this.fb=b(V),this.pendingKyc=h([]),this.orders=h([]),this.actionForm=this.fb.nonNullable.group({notes:["Reviewed",w.required],payoutRef:[""],reason:[""]})}ngOnInit(){this.loadKyc(),this.loadOrders()}loadKyc(){this.api.adminListPendingKyc().subscribe(e=>this.pendingKyc.set(e))}loadOrders(){this.api.listOrders().subscribe(e=>this.orders.set(e))}approve(e){this.api.adminApproveKyc(e,this.actionForm.controls.notes.value).subscribe(()=>this.loadKyc())}reject(e){this.api.adminRejectKyc(e,this.actionForm.controls.notes.value).subscribe(()=>this.loadKyc())}confirm(e){this.api.adminConfirmFunds(e).subscribe(()=>this.loadOrders())}sent(e){this.api.adminMarkSent(e,this.actionForm.controls.payoutRef.value||"manual").subscribe(()=>this.loadOrders())}complete(e){this.api.adminMarkCompleted(e).subscribe(()=>this.loadOrders())}flag(e){this.api.adminFlagSuspicious(e,this.actionForm.controls.reason.value||"manual review").subscribe(()=>this.loadOrders())}static{this.\u0275fac=function(a){return new(a||r)}}static{this.\u0275cmp=F({type:r,selectors:[["ng-component"]],standalone:!0,features:[E],decls:28,vars:4,consts:[[1,"ion-padding"],["position","stacked"],[3,"formControl"],[1,"empty-state"],["size","small",3,"click"],["size","small","color","danger",3,"click"],["size","small","color","warning",3,"click"]],template:function(a,n){a&1&&(i(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),o(3,"Admin"),t()()(),i(4,"ion-content",0)(5,"ion-item")(6,"ion-label",1),o(7,"Notes"),t(),f(8,"ion-input",2),t(),i(9,"ion-item")(10,"ion-label",1),o(11,"Payout Ref / Tx Hash"),t(),f(12,"ion-input",2),t(),i(13,"ion-item")(14,"ion-label",1),o(15,"Flag reason"),t(),f(16,"ion-input",2),t(),i(17,"h2"),o(18,"Pending KYC"),t(),S(19,B,2,0,"div",3),i(20,"ion-list"),g(21,H,10,3,"ion-item",null,L),t(),i(23,"h2"),o(24,"Orders"),t(),i(25,"ion-list"),g(26,Y,12,2,"ion-item",null,L),t()()),a&2&&(s(8),_("formControl",n.actionForm.controls.notes),s(4),_("formControl",n.actionForm.controls.payoutRef),s(4),_("formControl",n.actionForm.controls.reason),s(3),y(19,n.pendingKyc().length===0?19:-1),s(2),x(n.pendingKyc()),s(5),x(n.orders()))},dependencies:[O,N,j,K,M,$,R,T,z,P,A,I],encapsulation:2})}}return r})();export{Z as AdminPage};
